#! /usr/local/bin/Rscript

# brew install smokris/getwindowid/getwindowid
# getwindowid RStudio --list

# Resize RStudio window to 1920 x 1600
# windows <- system("getwindowid RStudio --list", intern = TRUE)
# window <- grep("rsthemes - assets", windows, value = TRUE)
# rstudio_window <- strsplit(window, "id=")[[1]][2] # replace with window id found above
rstudio_window <- 133078
themes <- rsthemes::list_rsthemes(list_installed = FALSE)

system("./resize-rstudio", wait = TRUE)
rstudioapi::executeCommand("activateConsole")
rstudioapi::executeCommand("consoleClear")
rstudioapi::sendToConsole('remotes::install_github("gadenbuie/rsthemes")\nrsthemes::install_rsthemes()', execute = FALSE)

Sys.sleep(4)

for (theme in themes) {
  rstudioapi::applyTheme(theme)
  Sys.sleep(1.5)
  theme_file <- sub(" {rsthemes}", "", theme, fixed = TRUE)
  theme_file <- gsub("[ ,;()-]", "_", theme_file)
  theme_file <- tolower(theme_file)
  theme_file <- here::here("themes", theme_file)
  cmd <- glue::glue(
    "screencapture -o -l{rstudio_window} {theme_file}.png"
  )
  system(cmd, wait = TRUE)
}
